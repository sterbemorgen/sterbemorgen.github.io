<!--Available categories: book, movie, tv, podcast, music, game, performance-->
{{ $category := .Get 0 }}
<!--Available types: wishlist, progress, complete-->
{{ $type := .Get 1 }}

{{ if eq $type "" }}
{{ $type = "complete" }}
{{ end }}

<!-- æ­£ç¡®æ„å»º URL -->
{{ $url := printf "https://neodb-worker.littlelittlecy.workers.dev/%s?type=%s" $category $type }}

<!-- ä½¿ç”¨ GetRemote è·å–è¿œç¨‹ JSON æ•°æ®å¹¶è¿›è¡Œè§£ç  -->
{{ $jsonResource := resources.GetRemote $url }}
{{ $json := $jsonResource | transform.Unmarshal }}

<div class="neodb-container">
    <div class="item-gallery">
        {{ range first 10 $json.data }} <!-- ä»…è·å–å‰10ä¸ªæ•°æ® -->
        {{ $item := .item }}
        <div class="item-card">
            <a class="item-card-upper" href="{{ $item.id }}" target="_blank" rel="noreferrer">
                <img class="item-cover" src="{{ $item.cover_image_url }}" alt="{{ $item.display_title }}" loading="lazy">
            </a>
            {{ if $item.rating }}
            <div class="rate">
                <span><b>{{ $item.rating }}</b>ğŸŒŸ</span>
                <br>
                <span class="rating-count"> {{ $item.rating_count }} ratings</span>
            </div>
            {{ else }}
            <div class="rate">
                <span>No ratings yetğŸŒŸ</span>
                <br>
                <span class="rating-count"> {{ $item.rating_count }} ratings</span>
            </div>
            {{ end }}
            <h3 class="item-title">{{ $item.display_title }}</h3>
        </div>
        {{ end }}
    </div>
</div>

<style>
    .neodb-container {
        width: 100%;
        overflow: hidden;
        margin: 20px 0;
    }

    .item-gallery {
        display: flex;
        padding: 0 1rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        align-items: baseline;
        gap: 0.5rem;
    }

    .item-card {
        display: flex;
        flex-direction: column;
        flex: 0 0 auto;
        margin: 0 0.5rem 1rem;
        border-radius: 5px;
        transition: transform 0.2s;
        width: 8rem;
        min-width: 8rem;
    }

    .item-card:hover {
        transform: translateY(-5px);
    }

    .rate {
        text-align: center;
        font-size: 0.85rem;
        margin-bottom: 0px;
    }

    .rating-count {
        font-size: 0.75rem !important;
        color: grey;
    }

    .item-cover {
        width: 100%;
        height: auto;
        min-height: 3rem;
        border: 2px solid transparent;
        object-fit: cover;
    }

    .item-title {
        font-size: 0.85rem !important;
        text-align: center;
        margin: 0px 0 0 0;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }

    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    @media screen and (max-width: 768px) {
        .neodb-container {
            margin: 15px -16px; /* è´Ÿmarginè®©ç”»å»Šå»¶ä¼¸åˆ°å±å¹•è¾¹ç¼˜ */
        }

        .item-gallery {
            padding: 0 16px;
            gap: 0.3rem;
        }

        .item-card {
            width: 6.5rem;
            min-width: 6.5rem;
            margin: 0 0.3rem 1rem;
        }

        .item-title {
            font-size: 0.75rem !important;
        }

        .rate {
            font-size: 0.75rem;
        }

        .rating-count {
            font-size: 0.65rem !important;
        }
    }

    /* å°å±æ‰‹æœºä¼˜åŒ– */
    @media screen and (max-width: 375px) {
        .item-card {
            width: 5.5rem;
            min-width: 5.5rem;
        }

        .item-title {
            font-size: 0.7rem !important;
        }
    }
</style>
